---
import { getCollection, type CollectionEntry } from "astro:content";
import ProjectCard from "../ui/ProjectCard.astro";

const projects = await getCollection("projects");
const featured = projects.filter(p => p.data.featured).slice(0, 4);
const sorted = featured.length > 0 ? featured : projects.slice(0, 4);
---

<section id="projects" class="py-16 md:py-20 px-4 md:px-8 max-w-5xl mx-auto">
    <div class="flex items-center justify-between mb-12">
        <h2 class="text-3xl font-heading font-bold text-accent">Featured Projects</h2>
        <a href="/projects" class="text-sm text-accent hover:underline transition-colors focus:outline-none focus:ring-2 focus:ring-accent rounded px-2 py-1 font-heading">
            View all â†’
        </a>
    </div>

    <div class="grid md:grid-cols-2 gap-6 md:gap-8">
        {sorted.map((project: CollectionEntry<"projects">) => (
            <ProjectCard
                title={project.data.title}
                description={project.data.description}
                tech={project.data.tech}
                github={project.data.github}
                liveLink={project.data.liveLink}
                image={project.data.image}
                featured={project.data.featured}
                href={`/projects/${project.slug}`}
            />
        ))}
    </div>
</section>
