---
import { getCollection, type CollectionEntry } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";

const posts = await getCollection("blog");
const published = posts.filter(p => p.data.published !== false);
const sorted = published.sort((a, b) =>
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<BaseLayout 
  title="Blog â€“ Kristee Joy Dutaro" 
  description="Read my articles about web development, full-stack development, and modern technologies."
  canonical="/blog"
>
    <section class="py-16 px-4 md:px-8 max-w-5xl mx-auto">
        <h1 class="text-4xl font-bold mb-4 text-zinc-100">Blog</h1>
        <p class="text-zinc-400 mb-12 max-w-2xl">
            Articles and insights about web development, modern technologies, and best practices.
        </p>

        <div class="flex items-center justify-between mb-6">
            <p class="text-sm text-zinc-400">{sorted.length} articles</p>
            <a href="/blog/rss.xml" class="text-sm text-zinc-400 hover:text-zinc-100 transition-colors flex items-center gap-2">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M5 3a2 2 0 00-2 2v2c0 1.1.9 2 2 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2c0 1.1.9 2 2 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM14 11a1 1 0 00-1 1v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1v-1a1 1 0 00-1-1z"></path>
                </svg>
                RSS Feed
            </a>
        </div>

        <ul class="space-y-6">
        {sorted.map((post: CollectionEntry<"blog">) => (
            <li>
            <a
                href={`/blog/${post.slug}`}
                class="block p-6 border border-zinc-800 rounded-lg hover:border-zinc-600 hover:bg-zinc-900/50 transition-all"
            >
                <div class="flex items-start justify-between gap-4 mb-2">
                    <h2 class="text-xl font-semibold text-zinc-100">{post.data.title}</h2>
                    <time class="text-xs text-zinc-500 whitespace-nowrap">
                        {post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })}
                    </time>
                </div>
                <p class="text-zinc-300 mb-3">{post.data.description}</p>
                {post.data.tags && post.data.tags.length > 0 && (
                    <div class="flex flex-wrap gap-2">
                        {post.data.tags.map(tag => (
                            <span class="text-xs bg-zinc-800 text-zinc-400 px-2 py-1 rounded">
                                {tag}
                            </span>
                        ))}
                    </div>
                )}
            </a>
            </li>
        ))}
        </ul>
    </section>
</BaseLayout>
